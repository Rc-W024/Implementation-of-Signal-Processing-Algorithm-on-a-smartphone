/*
 * File: L6_1.c
 *
 * MATLAB Coder version            : 2.8
 * C/C++ source code generated on  : 27-Apr-2016 13:23:03
 */

/* Include Files */
#include "rt_nonfinite.h"
#include "L6_1.h"
#include "L6_1_emxutil.h"
#include "round.h"
#include "sin.h"

/* Function Definitions */

/*
 * Arguments    : double b
 *                double fs
 *                double f
 *                double A
 *                double q
 *                double xa[2001]
 *                emxArray_real_T *xd1
 *                emxArray_real_T *x_recon
 * Return Type  : void
 */
void L6_1(double b, double fs, double f, double A, double q, double *xa,
          emxArray_real_T *xd1, emxArray_real_T *x_recon)
{
  double theta;
  double dn;
  double ndbl;
  int mid_i;
  static const double b_b[2001] = { 0.0, 0.0001, 0.0002, 0.00030000000000000003,
    0.0004, 0.0005, 0.00060000000000000006, 0.0007, 0.0008,
    0.00090000000000000008, 0.001, 0.0011, 0.0012000000000000001,
    0.0013000000000000002, 0.0014, 0.0015, 0.0016, 0.0017000000000000001,
    0.0018000000000000002, 0.0019, 0.002, 0.0021000000000000003, 0.0022, 0.0023,
    0.0024000000000000002, 0.0025, 0.0026000000000000003, 0.0027, 0.0028,
    0.0029000000000000002, 0.003, 0.0031000000000000003, 0.0032, 0.0033,
    0.0034000000000000002, 0.0035, 0.0036000000000000003, 0.0037, 0.0038,
    0.0039000000000000003, 0.004, 0.0041, 0.0042000000000000006, 0.0043, 0.0044,
    0.0045000000000000005, 0.0046, 0.0047, 0.0048000000000000004, 0.0049, 0.005,
    0.0051, 0.0052000000000000006, 0.0053, 0.0054, 0.0055000000000000005, 0.0056,
    0.0057, 0.0058000000000000005, 0.0059, 0.006, 0.0061, 0.0062000000000000006,
    0.0063, 0.0064, 0.0065000000000000006, 0.0066, 0.0067, 0.0068000000000000005,
    0.0069000000000000008, 0.007, 0.0071, 0.0072000000000000007, 0.0073, 0.0074,
    0.0075000000000000006, 0.0076, 0.0077, 0.0078000000000000005, 0.0079, 0.008,
    0.0081, 0.0082, 0.0083, 0.0084000000000000012, 0.0085, 0.0086,
    0.0087000000000000011, 0.0088, 0.0089, 0.0090000000000000011, 0.0091, 0.0092,
    0.009300000000000001, 0.0094, 0.0095, 0.0096000000000000009, 0.0097, 0.0098,
    0.0099, 0.01, 0.010100000000000001, 0.0102, 0.0103, 0.010400000000000001,
    0.0105, 0.0106, 0.010700000000000001, 0.0108, 0.0109, 0.011000000000000001,
    0.0111, 0.0112, 0.011300000000000001, 0.0114, 0.0115, 0.011600000000000001,
    0.0117, 0.0118, 0.0119, 0.012, 0.012100000000000001, 0.0122, 0.0123,
    0.012400000000000001, 0.0125, 0.0126, 0.012700000000000001, 0.0128, 0.0129,
    0.013000000000000001, 0.0131, 0.0132, 0.013300000000000001, 0.0134, 0.0135,
    0.013600000000000001, 0.0137, 0.013800000000000002, 0.013900000000000001,
    0.014, 0.014100000000000001, 0.0142, 0.0143, 0.014400000000000001, 0.0145,
    0.0146, 0.014700000000000001, 0.0148, 0.0149, 0.015000000000000001, 0.0151,
    0.0152, 0.015300000000000001, 0.0154, 0.0155, 0.015600000000000001,
    0.015700000000000002, 0.0158, 0.0159, 0.016, 0.0161, 0.0162,
    0.016300000000000002, 0.0164, 0.0165, 0.0166, 0.0167, 0.016800000000000002,
    0.016900000000000002, 0.017, 0.0171, 0.0172, 0.0173, 0.017400000000000002,
    0.0175, 0.0176, 0.0177, 0.0178, 0.0179, 0.018000000000000002, 0.0181, 0.0182,
    0.0183, 0.0184, 0.018500000000000003, 0.018600000000000002, 0.0187, 0.0188,
    0.0189, 0.019, 0.019100000000000002, 0.019200000000000002, 0.0193, 0.0194,
    0.0195, 0.0196, 0.019700000000000002, 0.0198, 0.0199, 0.02, 0.0201,
    0.020200000000000003, 0.020300000000000002, 0.0204, 0.0205, 0.0206, 0.0207,
    0.020800000000000003, 0.020900000000000002, 0.021, 0.0211, 0.0212, 0.0213,
    0.021400000000000002, 0.021500000000000002, 0.0216, 0.0217, 0.0218, 0.0219,
    0.022000000000000002, 0.0221, 0.0222, 0.0223, 0.0224, 0.022500000000000003,
    0.022600000000000002, 0.0227, 0.0228, 0.0229, 0.023, 0.023100000000000002,
    0.023200000000000002, 0.0233, 0.0234, 0.0235, 0.0236, 0.023700000000000002,
    0.0238, 0.0239, 0.024, 0.0241, 0.024200000000000003, 0.024300000000000002,
    0.0244, 0.0245, 0.0246, 0.0247, 0.024800000000000003, 0.024900000000000002,
    0.025, 0.0251, 0.0252, 0.0253, 0.025400000000000002, 0.025500000000000002,
    0.0256, 0.0257, 0.0258, 0.025900000000000003, 0.026000000000000002, 0.0261,
    0.0262, 0.0263, 0.0264, 0.026500000000000003, 0.026600000000000002, 0.0267,
    0.0268, 0.0269, 0.027, 0.027100000000000003, 0.027200000000000002, 0.0273,
    0.0274, 0.0275, 0.027600000000000003, 0.027700000000000002,
    0.027800000000000002, 0.0279, 0.028, 0.0281, 0.028200000000000003,
    0.028300000000000002, 0.0284, 0.0285, 0.0286, 0.0287, 0.028800000000000003,
    0.028900000000000002, 0.029, 0.0291, 0.0292, 0.029300000000000003,
    0.029400000000000003, 0.029500000000000002, 0.0296, 0.0297, 0.0298,
    0.029900000000000003, 0.030000000000000002, 0.030100000000000002, 0.0302,
    0.0303, 0.0304, 0.030500000000000003, 0.030600000000000002, 0.0307, 0.0308,
    0.0309, 0.031, 0.031100000000000003, 0.031200000000000002, 0.0313,
    0.031400000000000004, 0.0315, 0.0316, 0.0317, 0.0318, 0.031900000000000005,
    0.032, 0.032100000000000004, 0.0322, 0.0323, 0.0324, 0.0325,
    0.032600000000000004, 0.0327, 0.0328, 0.0329, 0.033, 0.033100000000000004,
    0.0332, 0.0333, 0.0334, 0.0335, 0.033600000000000005, 0.0337,
    0.033800000000000004, 0.0339, 0.034, 0.0341, 0.0342, 0.034300000000000004,
    0.0344, 0.0345, 0.0346, 0.0347, 0.034800000000000005, 0.0349, 0.035, 0.0351,
    0.0352, 0.035300000000000005, 0.0354, 0.035500000000000004, 0.0356, 0.0357,
    0.0358, 0.0359, 0.036000000000000004, 0.0361, 0.0362, 0.0363, 0.0364,
    0.036500000000000005, 0.0366, 0.0367, 0.0368, 0.0369, 0.037000000000000005,
    0.0371, 0.037200000000000004, 0.0373, 0.0374, 0.0375, 0.0376,
    0.037700000000000004, 0.0378, 0.0379, 0.038, 0.0381, 0.038200000000000005,
    0.0383, 0.038400000000000004, 0.0385, 0.0386, 0.038700000000000005, 0.0388,
    0.038900000000000004, 0.039, 0.0391, 0.0392, 0.0393, 0.039400000000000004,
    0.0395, 0.0396, 0.0397, 0.0398, 0.039900000000000005, 0.04,
    0.040100000000000004, 0.0402, 0.0403, 0.040400000000000005, 0.0405,
    0.040600000000000004, 0.0407, 0.0408, 0.0409, 0.041, 0.041100000000000005,
    0.0412, 0.0413, 0.0414, 0.0415, 0.041600000000000005, 0.0417,
    0.041800000000000004, 0.0419, 0.042, 0.042100000000000005, 0.0422,
    0.042300000000000004, 0.0424, 0.0425, 0.0426, 0.0427, 0.042800000000000005,
    0.0429, 0.043000000000000003, 0.0431, 0.0432, 0.043300000000000005, 0.0434,
    0.043500000000000004, 0.0436, 0.0437, 0.0438, 0.0439, 0.044000000000000004,
    0.0441, 0.0442, 0.0443, 0.0444, 0.044500000000000005, 0.0446,
    0.044700000000000004, 0.0448, 0.0449, 0.045000000000000005, 0.0451,
    0.045200000000000004, 0.0453, 0.0454, 0.0455, 0.0456, 0.045700000000000005,
    0.0458, 0.0459, 0.046, 0.0461, 0.046200000000000005, 0.0463,
    0.046400000000000004, 0.0465, 0.0466, 0.046700000000000005, 0.0468,
    0.046900000000000004, 0.047, 0.0471, 0.0472, 0.0473, 0.047400000000000005,
    0.0475, 0.0476, 0.0477, 0.0478, 0.047900000000000005, 0.048,
    0.048100000000000004, 0.0482, 0.0483, 0.048400000000000006, 0.0485,
    0.048600000000000004, 0.0487, 0.0488, 0.0489, 0.049, 0.049100000000000005,
    0.0492, 0.049300000000000004, 0.0494, 0.0495, 0.049600000000000005, 0.0497,
    0.049800000000000004, 0.0499, 0.05, 0.050100000000000006, 0.0502,
    0.050300000000000004, 0.0504, 0.0505, 0.0506, 0.0507, 0.050800000000000005,
    0.0509, 0.051000000000000004, 0.0511, 0.0512, 0.051300000000000005, 0.0514,
    0.051500000000000004, 0.0516, 0.0517, 0.051800000000000006, 0.0519,
    0.052000000000000005, 0.0521, 0.0522, 0.0523, 0.0524, 0.052500000000000005,
    0.0526, 0.052700000000000004, 0.0528, 0.0529, 0.053000000000000005, 0.0531,
    0.053200000000000004, 0.0533, 0.0534, 0.053500000000000006, 0.0536,
    0.053700000000000005, 0.0538, 0.0539, 0.054, 0.0541, 0.054200000000000005,
    0.0543, 0.054400000000000004, 0.0545, 0.0546, 0.054700000000000006, 0.0548,
    0.054900000000000004, 0.055, 0.0551, 0.055200000000000006, 0.0553,
    0.055400000000000005, 0.0555, 0.055600000000000004, 0.0557, 0.0558,
    0.055900000000000005, 0.056, 0.056100000000000004, 0.0562, 0.0563,
    0.056400000000000006, 0.0565, 0.056600000000000004, 0.0567, 0.0568,
    0.056900000000000006, 0.057, 0.057100000000000005, 0.0572,
    0.057300000000000004, 0.0574, 0.0575, 0.057600000000000005, 0.0577,
    0.057800000000000004, 0.0579, 0.058, 0.058100000000000006, 0.0582,
    0.058300000000000005, 0.0584, 0.0585, 0.058600000000000006, 0.0587,
    0.058800000000000005, 0.0589, 0.059000000000000004, 0.0591, 0.0592,
    0.059300000000000005, 0.0594, 0.059500000000000004, 0.0596, 0.0597,
    0.059800000000000006, 0.0599, 0.060000000000000005, 0.0601,
    0.060200000000000004, 0.0603, 0.0604, 0.060500000000000005, 0.0606,
    0.060700000000000004, 0.0608, 0.0609, 0.061000000000000006, 0.0611,
    0.061200000000000004, 0.0613, 0.0614, 0.061500000000000006, 0.0616,
    0.061700000000000005, 0.0618, 0.061900000000000004, 0.062, 0.0621,
    0.062200000000000005, 0.0623, 0.062400000000000004, 0.0625, 0.0626, 0.0627,
    0.062800000000000009, 0.0629, 0.063, 0.0631, 0.0632, 0.063300000000000009,
    0.0634, 0.0635, 0.0636, 0.0637, 0.063800000000000009, 0.0639, 0.064, 0.0641,
    0.064200000000000007, 0.06430000000000001, 0.0644, 0.0645, 0.0646,
    0.064700000000000008, 0.0648, 0.0649, 0.065, 0.0651, 0.065200000000000008,
    0.0653, 0.0654, 0.0655, 0.0656, 0.065700000000000008, 0.0658, 0.0659, 0.066,
    0.0661, 0.066200000000000009, 0.0663, 0.0664, 0.0665, 0.0666,
    0.066700000000000009, 0.0668, 0.0669, 0.067, 0.0671, 0.06720000000000001,
    0.0673, 0.0674, 0.0675, 0.067600000000000007, 0.06770000000000001, 0.0678,
    0.0679, 0.068, 0.068100000000000008, 0.0682, 0.0683, 0.0684, 0.0685,
    0.068600000000000008, 0.0687, 0.0688, 0.0689, 0.069, 0.069100000000000009,
    0.0692, 0.0693, 0.0694, 0.0695, 0.069600000000000009, 0.0697, 0.0698, 0.0699,
    0.07, 0.07010000000000001, 0.0702, 0.0703, 0.0704, 0.070500000000000007,
    0.07060000000000001, 0.0707, 0.0708, 0.0709, 0.071000000000000008, 0.0711,
    0.0712, 0.0713, 0.0714, 0.071500000000000008, 0.0716, 0.0717, 0.0718, 0.0719,
    0.072000000000000008, 0.0721, 0.0722, 0.0723, 0.0724, 0.072500000000000009,
    0.0726, 0.0727, 0.0728, 0.0729, 0.073000000000000009, 0.0731, 0.0732, 0.0733,
    0.0734, 0.07350000000000001, 0.0736, 0.0737, 0.0738, 0.073900000000000007,
    0.07400000000000001, 0.0741, 0.0742, 0.0743, 0.074400000000000008, 0.0745,
    0.0746, 0.0747, 0.0748, 0.074900000000000008, 0.075, 0.0751, 0.0752, 0.0753,
    0.075400000000000009, 0.0755, 0.0756, 0.0757, 0.0758, 0.075900000000000009,
    0.076, 0.0761, 0.0762, 0.0763, 0.07640000000000001, 0.0765, 0.0766, 0.0767,
    0.076800000000000007, 0.07690000000000001, 0.077, 0.0771, 0.0772,
    0.077300000000000008, 0.07740000000000001, 0.0775, 0.0776, 0.0777,
    0.077800000000000008, 0.0779, 0.078, 0.0781, 0.0782, 0.078300000000000008,
    0.0784, 0.0785, 0.0786, 0.0787, 0.078800000000000009, 0.0789, 0.079, 0.0791,
    0.0792, 0.079300000000000009, 0.0794, 0.0795, 0.0796, 0.079700000000000007,
    0.07980000000000001, 0.0799, 0.08, 0.0801, 0.080200000000000007,
    0.08030000000000001, 0.0804, 0.0805, 0.0806, 0.080700000000000008,
    0.080800000000000011, 0.0809, 0.081, 0.0811, 0.081200000000000008, 0.0813,
    0.0814, 0.0815, 0.0816, 0.081700000000000009, 0.0818, 0.0819, 0.082, 0.0821,
    0.082200000000000009, 0.0823, 0.0824, 0.0825, 0.0826, 0.08270000000000001,
    0.0828, 0.0829, 0.083, 0.083100000000000007, 0.08320000000000001, 0.0833,
    0.0834, 0.0835, 0.083600000000000008, 0.083700000000000011, 0.0838, 0.0839,
    0.084, 0.084100000000000008, 0.084200000000000011, 0.0843, 0.0844, 0.0845,
    0.084600000000000009, 0.0847, 0.0848, 0.0849, 0.085, 0.085100000000000009,
    0.0852, 0.0853, 0.0854, 0.0855, 0.085600000000000009, 0.0857, 0.0858, 0.0859,
    0.086000000000000007, 0.08610000000000001, 0.0862, 0.0863, 0.0864,
    0.086500000000000007, 0.08660000000000001, 0.0867, 0.0868, 0.0869,
    0.087000000000000008, 0.087100000000000011, 0.0872, 0.0873, 0.0874,
    0.087500000000000008, 0.0876, 0.0877, 0.0878, 0.0879, 0.088000000000000009,
    0.0881, 0.0882, 0.0883, 0.0884, 0.088500000000000009, 0.0886, 0.0887, 0.0888,
    0.0889, 0.08900000000000001, 0.0891, 0.0892, 0.0893, 0.089400000000000007,
    0.08950000000000001, 0.0896, 0.0897, 0.0898, 0.089900000000000008,
    0.090000000000000011, 0.0901, 0.0902, 0.0903, 0.090400000000000008,
    0.090500000000000011, 0.0906, 0.0907, 0.0908, 0.090900000000000009, 0.091,
    0.0911, 0.0912, 0.0913, 0.091400000000000009, 0.0915, 0.0916, 0.0917, 0.0918,
    0.091900000000000009, 0.092, 0.0921, 0.0922, 0.092300000000000007,
    0.09240000000000001, 0.0925, 0.0926, 0.0927, 0.092800000000000007,
    0.09290000000000001, 0.093, 0.0931, 0.0932, 0.093300000000000008,
    0.093400000000000011, 0.0935, 0.0936, 0.0937, 0.093800000000000008,
    0.093900000000000011, 0.094, 0.0941, 0.0942, 0.094300000000000009, 0.0944,
    0.0945, 0.0946, 0.0947, 0.094800000000000009, 0.0949, 0.095, 0.0951, 0.0952,
    0.09530000000000001, 0.0954, 0.0955, 0.0956, 0.095700000000000007,
    0.09580000000000001, 0.0959, 0.096, 0.0961, 0.096200000000000008,
    0.096300000000000011, 0.0964, 0.0965, 0.0966, 0.096700000000000008,
    0.096800000000000011, 0.0969, 0.097, 0.0971, 0.097200000000000009,
    0.097300000000000011, 0.0974, 0.0975, 0.0976, 0.097700000000000009, 0.0978,
    0.0979, 0.098, 0.0981, 0.09820000000000001, 0.0983, 0.0984, 0.0985,
    0.098600000000000007, 0.09870000000000001, 0.0988, 0.0989, 0.099,
    0.099100000000000008, 0.09920000000000001, 0.0993, 0.0994, 0.0995,
    0.099600000000000008, 0.099700000000000011, 0.0998, 0.0999, 0.1,
    0.10010000000000001, 0.10020000000000001, 0.1003, 0.1004, 0.1005,
    0.10060000000000001, 0.10070000000000001, 0.1008, 0.1009, 0.101,
    0.10110000000000001, 0.10120000000000001, 0.1013, 0.1014, 0.1015,
    0.10160000000000001, 0.10170000000000001, 0.1018, 0.1019,
    0.10200000000000001, 0.10210000000000001, 0.10220000000000001, 0.1023,
    0.1024, 0.10250000000000001, 0.10260000000000001, 0.1027, 0.1028, 0.1029,
    0.10300000000000001, 0.10310000000000001, 0.1032, 0.1033, 0.1034,
    0.10350000000000001, 0.10360000000000001, 0.1037, 0.1038, 0.1039,
    0.10400000000000001, 0.10410000000000001, 0.1042, 0.1043, 0.1044,
    0.10450000000000001, 0.10460000000000001, 0.1047, 0.1048,
    0.10490000000000001, 0.10500000000000001, 0.10510000000000001, 0.1052,
    0.1053, 0.10540000000000001, 0.10550000000000001, 0.10560000000000001,
    0.1057, 0.1058, 0.10590000000000001, 0.10600000000000001, 0.1061, 0.1062,
    0.1063, 0.10640000000000001, 0.10650000000000001, 0.1066, 0.1067, 0.1068,
    0.10690000000000001, 0.10700000000000001, 0.1071, 0.1072, 0.1073,
    0.10740000000000001, 0.10750000000000001, 0.1076, 0.1077, 0.1078,
    0.10790000000000001, 0.10800000000000001, 0.1081, 0.1082,
    0.10830000000000001, 0.10840000000000001, 0.10850000000000001, 0.1086,
    0.1087, 0.10880000000000001, 0.10890000000000001, 0.10900000000000001,
    0.1091, 0.1092, 0.10930000000000001, 0.10940000000000001, 0.1095, 0.1096,
    0.1097, 0.10980000000000001, 0.10990000000000001, 0.11, 0.1101, 0.1102,
    0.11030000000000001, 0.11040000000000001, 0.1105, 0.1106, 0.1107,
    0.11080000000000001, 0.11090000000000001, 0.111, 0.1111, 0.11120000000000001,
    0.11130000000000001, 0.11140000000000001, 0.1115, 0.1116,
    0.11170000000000001, 0.11180000000000001, 0.11190000000000001, 0.112, 0.1121,
    0.11220000000000001, 0.11230000000000001, 0.11240000000000001, 0.1125,
    0.1126, 0.11270000000000001, 0.11280000000000001, 0.1129, 0.113, 0.1131,
    0.11320000000000001, 0.11330000000000001, 0.1134, 0.1135, 0.1136,
    0.11370000000000001, 0.11380000000000001, 0.1139, 0.114, 0.11410000000000001,
    0.11420000000000001, 0.11430000000000001, 0.1144, 0.1145,
    0.11460000000000001, 0.11470000000000001, 0.11480000000000001, 0.1149, 0.115,
    0.11510000000000001, 0.11520000000000001, 0.11530000000000001, 0.1154,
    0.1155, 0.11560000000000001, 0.11570000000000001, 0.1158, 0.1159, 0.116,
    0.11610000000000001, 0.11620000000000001, 0.1163, 0.1164, 0.1165,
    0.11660000000000001, 0.11670000000000001, 0.1168, 0.1169, 0.117,
    0.11710000000000001, 0.11720000000000001, 0.1173, 0.1174,
    0.11750000000000001, 0.11760000000000001, 0.11770000000000001, 0.1178,
    0.1179, 0.11800000000000001, 0.11810000000000001, 0.11820000000000001,
    0.1183, 0.1184, 0.11850000000000001, 0.11860000000000001,
    0.11870000000000001, 0.1188, 0.1189, 0.11900000000000001,
    0.11910000000000001, 0.1192, 0.1193, 0.1194, 0.11950000000000001,
    0.11960000000000001, 0.1197, 0.1198, 0.1199, 0.12000000000000001,
    0.12010000000000001, 0.1202, 0.1203, 0.12040000000000001,
    0.12050000000000001, 0.12060000000000001, 0.1207, 0.1208,
    0.12090000000000001, 0.12100000000000001, 0.12110000000000001, 0.1212,
    0.1213, 0.12140000000000001, 0.12150000000000001, 0.12160000000000001,
    0.1217, 0.1218, 0.12190000000000001, 0.12200000000000001,
    0.12210000000000001, 0.1222, 0.1223, 0.12240000000000001,
    0.12250000000000001, 0.1226, 0.1227, 0.1228, 0.12290000000000001,
    0.12300000000000001, 0.1231, 0.1232, 0.1233, 0.12340000000000001,
    0.12350000000000001, 0.1236, 0.1237, 0.12380000000000001,
    0.12390000000000001, 0.12400000000000001, 0.1241, 0.1242,
    0.12430000000000001, 0.12440000000000001, 0.12450000000000001, 0.1246,
    0.1247, 0.12480000000000001, 0.12490000000000001, 0.125, 0.1251, 0.1252,
    0.12530000000000002, 0.1254, 0.1255, 0.1256, 0.1257, 0.12580000000000002,
    0.1259, 0.126, 0.1261, 0.1262, 0.12630000000000002, 0.1264, 0.1265, 0.1266,
    0.1267, 0.12680000000000002, 0.1269, 0.127, 0.1271, 0.1272,
    0.12730000000000002, 0.1274, 0.1275, 0.1276, 0.1277, 0.12780000000000002,
    0.1279, 0.128, 0.1281, 0.1282, 0.12830000000000003, 0.12840000000000001,
    0.1285, 0.1286, 0.1287, 0.12880000000000003, 0.12890000000000001, 0.129,
    0.1291, 0.1292, 0.12930000000000003, 0.12940000000000002, 0.1295, 0.1296,
    0.1297, 0.12980000000000003, 0.12990000000000002, 0.13, 0.1301, 0.1302,
    0.13030000000000003, 0.13040000000000002, 0.1305, 0.1306, 0.1307,
    0.13080000000000003, 0.13090000000000002, 0.131, 0.1311, 0.1312,
    0.13130000000000003, 0.13140000000000002, 0.1315, 0.1316, 0.1317,
    0.13180000000000003, 0.13190000000000002, 0.132, 0.1321, 0.1322, 0.1323,
    0.13240000000000002, 0.1325, 0.1326, 0.1327, 0.1328, 0.13290000000000002,
    0.133, 0.1331, 0.1332, 0.1333, 0.13340000000000002, 0.1335, 0.1336, 0.1337,
    0.1338, 0.13390000000000002, 0.134, 0.1341, 0.1342, 0.1343,
    0.13440000000000002, 0.1345, 0.1346, 0.13470000000000001, 0.1348,
    0.13490000000000002, 0.135, 0.1351, 0.13520000000000001, 0.1353,
    0.13540000000000002, 0.1355, 0.1356, 0.1357, 0.1358, 0.13590000000000002,
    0.136, 0.1361, 0.1362, 0.1363, 0.13640000000000002, 0.1365, 0.1366, 0.1367,
    0.1368, 0.13690000000000002, 0.137, 0.1371, 0.1372, 0.1373,
    0.13740000000000002, 0.1375, 0.1376, 0.13770000000000002, 0.1378,
    0.13790000000000002, 0.138, 0.1381, 0.13820000000000002, 0.1383,
    0.13840000000000002, 0.1385, 0.1386, 0.13870000000000002, 0.1388,
    0.13890000000000002, 0.139, 0.1391, 0.13920000000000002, 0.1393,
    0.13940000000000002, 0.1395, 0.1396, 0.13970000000000002, 0.1398,
    0.13990000000000002, 0.14, 0.1401, 0.1402, 0.1403, 0.14040000000000002,
    0.1405, 0.1406, 0.1407, 0.1408, 0.14090000000000003, 0.14100000000000001,
    0.1411, 0.1412, 0.1413, 0.1414, 0.14150000000000001, 0.1416, 0.1417, 0.1418,
    0.1419, 0.14200000000000002, 0.1421, 0.1422, 0.1423, 0.1424,
    0.14250000000000002, 0.1426, 0.1427, 0.1428, 0.1429, 0.14300000000000002,
    0.1431, 0.1432, 0.1433, 0.1434, 0.14350000000000002, 0.1436, 0.1437, 0.1438,
    0.1439, 0.14400000000000002, 0.1441, 0.1442, 0.1443, 0.1444,
    0.14450000000000002, 0.1446, 0.1447, 0.1448, 0.1449, 0.14500000000000002,
    0.1451, 0.1452, 0.1453, 0.1454, 0.14550000000000002, 0.1456, 0.1457, 0.1458,
    0.1459, 0.14600000000000002, 0.1461, 0.1462, 0.1463, 0.1464,
    0.14650000000000002, 0.1466, 0.1467, 0.1468, 0.1469, 0.14700000000000002,
    0.1471, 0.1472, 0.14730000000000001, 0.1474, 0.14750000000000002, 0.1476,
    0.1477, 0.14780000000000001, 0.1479, 0.14800000000000002, 0.1481, 0.1482,
    0.14830000000000002, 0.1484, 0.14850000000000002, 0.1486, 0.1487,
    0.14880000000000002, 0.1489, 0.14900000000000002, 0.1491, 0.1492,
    0.14930000000000002, 0.1494, 0.14950000000000002, 0.1496, 0.1497,
    0.14980000000000002, 0.1499, 0.15000000000000002, 0.1501, 0.1502,
    0.15030000000000002, 0.1504, 0.15050000000000002, 0.1506, 0.1507,
    0.15080000000000002, 0.1509, 0.15100000000000002, 0.1511, 0.1512,
    0.15130000000000002, 0.1514, 0.15150000000000002, 0.1516, 0.1517,
    0.15180000000000002, 0.1519, 0.15200000000000002, 0.1521, 0.1522,
    0.15230000000000002, 0.1524, 0.15250000000000002, 0.1526, 0.1527,
    0.15280000000000002, 0.1529, 0.15300000000000002, 0.1531, 0.1532, 0.1533,
    0.1534, 0.15350000000000003, 0.15360000000000001, 0.1537, 0.1538, 0.1539,
    0.15400000000000003, 0.15410000000000001, 0.1542, 0.1543, 0.1544,
    0.15450000000000003, 0.15460000000000002, 0.1547, 0.1548, 0.1549, 0.155,
    0.15510000000000002, 0.1552, 0.1553, 0.1554, 0.1555, 0.15560000000000002,
    0.1557, 0.1558, 0.1559, 0.156, 0.15610000000000002, 0.1562, 0.1563, 0.1564,
    0.1565, 0.15660000000000002, 0.1567, 0.1568, 0.1569, 0.157,
    0.15710000000000002, 0.1572, 0.1573, 0.1574, 0.1575, 0.15760000000000002,
    0.1577, 0.1578, 0.1579, 0.158, 0.15810000000000002, 0.1582, 0.1583, 0.1584,
    0.1585, 0.15860000000000002, 0.1587, 0.1588, 0.1589, 0.159,
    0.15910000000000002, 0.1592, 0.1593, 0.15940000000000001, 0.1595,
    0.15960000000000002, 0.1597, 0.1598, 0.15990000000000001, 0.16,
    0.16010000000000002, 0.1602, 0.1603, 0.16040000000000001, 0.1605,
    0.16060000000000002, 0.1607, 0.1608, 0.16090000000000002, 0.161,
    0.16110000000000002, 0.1612, 0.1613, 0.16140000000000002, 0.1615,
    0.16160000000000002, 0.1617, 0.1618, 0.16190000000000002, 0.162,
    0.16210000000000002, 0.1622, 0.1623, 0.16240000000000002, 0.1625,
    0.16260000000000002, 0.1627, 0.1628, 0.16290000000000002, 0.163,
    0.16310000000000002, 0.1632, 0.1633, 0.16340000000000002, 0.1635,
    0.16360000000000002, 0.1637, 0.1638, 0.16390000000000002, 0.164,
    0.16410000000000002, 0.1642, 0.1643, 0.16440000000000002, 0.1645,
    0.16460000000000002, 0.1647, 0.1648, 0.16490000000000002, 0.165,
    0.16510000000000002, 0.1652, 0.1653, 0.16540000000000002, 0.1655,
    0.16560000000000002, 0.16570000000000001, 0.1658, 0.16590000000000002, 0.166,
    0.16610000000000003, 0.16620000000000001, 0.1663, 0.1664, 0.1665,
    0.16660000000000003, 0.16670000000000001, 0.1668, 0.1669, 0.167,
    0.16710000000000003, 0.16720000000000002, 0.1673, 0.1674, 0.1675,
    0.16760000000000003, 0.16770000000000002, 0.1678, 0.1679, 0.168, 0.1681,
    0.16820000000000002, 0.1683, 0.1684, 0.1685, 0.1686, 0.16870000000000002,
    0.1688, 0.1689, 0.169, 0.1691, 0.16920000000000002, 0.1693, 0.1694, 0.1695,
    0.1696, 0.16970000000000002, 0.1698, 0.1699, 0.17, 0.1701,
    0.17020000000000002, 0.1703, 0.1704, 0.1705, 0.1706, 0.17070000000000002,
    0.1708, 0.1709, 0.171, 0.1711, 0.17120000000000002, 0.1713, 0.1714, 0.1715,
    0.1716, 0.17170000000000002, 0.1718, 0.1719, 0.17200000000000001, 0.1721,
    0.17220000000000002, 0.1723, 0.1724, 0.17250000000000001, 0.1726,
    0.17270000000000002, 0.1728, 0.1729, 0.17300000000000001, 0.1731,
    0.17320000000000002, 0.1733, 0.1734, 0.17350000000000002, 0.1736,
    0.17370000000000002, 0.1738, 0.1739, 0.17400000000000002, 0.1741,
    0.17420000000000002, 0.1743, 0.1744, 0.17450000000000002, 0.1746,
    0.17470000000000002, 0.1748, 0.1749, 0.17500000000000002, 0.1751,
    0.17520000000000002, 0.1753, 0.1754, 0.17550000000000002, 0.1756,
    0.17570000000000002, 0.1758, 0.1759, 0.17600000000000002, 0.1761,
    0.17620000000000002, 0.1763, 0.1764, 0.17650000000000002, 0.1766,
    0.17670000000000002, 0.1768, 0.1769, 0.17700000000000002, 0.1771,
    0.17720000000000002, 0.1773, 0.1774, 0.17750000000000002, 0.1776,
    0.17770000000000002, 0.1778, 0.1779, 0.17800000000000002, 0.1781,
    0.17820000000000003, 0.17830000000000001, 0.1784, 0.17850000000000002,
    0.1786, 0.17870000000000003, 0.17880000000000001, 0.1789,
    0.17900000000000002, 0.1791, 0.1792, 0.17930000000000001, 0.1794,
    0.17950000000000002, 0.1796, 0.1797, 0.17980000000000002, 0.1799,
    0.18000000000000002, 0.1801, 0.1802, 0.18030000000000002, 0.1804,
    0.18050000000000002, 0.1806, 0.1807, 0.18080000000000002, 0.1809,
    0.18100000000000002, 0.1811, 0.1812, 0.18130000000000002, 0.1814, 0.1815,
    0.1816, 0.1817, 0.18180000000000002, 0.1819, 0.182, 0.1821, 0.1822,
    0.18230000000000002, 0.1824, 0.1825, 0.1826, 0.1827, 0.18280000000000002,
    0.1829, 0.183, 0.1831, 0.1832, 0.18330000000000002, 0.1834, 0.1835, 0.1836,
    0.1837, 0.18380000000000002, 0.1839, 0.184, 0.1841, 0.1842,
    0.18430000000000002, 0.1844, 0.1845, 0.18460000000000001, 0.1847,
    0.18480000000000002, 0.1849, 0.185, 0.18510000000000001, 0.1852,
    0.18530000000000002, 0.1854, 0.1855, 0.18560000000000001, 0.1857,
    0.18580000000000002, 0.1859, 0.186, 0.18610000000000002, 0.1862,
    0.18630000000000002, 0.1864, 0.1865, 0.18660000000000002, 0.1867,
    0.18680000000000002, 0.1869, 0.187, 0.18710000000000002, 0.1872,
    0.18730000000000002, 0.1874, 0.1875, 0.18760000000000002, 0.1877,
    0.18780000000000002, 0.1879, 0.188, 0.18810000000000002, 0.1882,
    0.18830000000000002, 0.1884, 0.1885, 0.18860000000000002, 0.1887,
    0.18880000000000002, 0.1889, 0.189, 0.18910000000000002, 0.1892,
    0.18930000000000002, 0.1894, 0.1895, 0.18960000000000002, 0.1897,
    0.18980000000000002, 0.1899, 0.19, 0.19010000000000002, 0.1902,
    0.19030000000000002, 0.1904, 0.1905, 0.19060000000000002, 0.1907,
    0.19080000000000003, 0.19090000000000001, 0.191, 0.19110000000000002, 0.1912,
    0.1913, 0.19140000000000001, 0.1915, 0.19160000000000002, 0.1917, 0.1918,
    0.19190000000000002, 0.192, 0.19210000000000002, 0.1922, 0.1923,
    0.19240000000000002, 0.1925, 0.19260000000000002, 0.1927, 0.1928,
    0.19290000000000002, 0.193, 0.19310000000000002, 0.1932, 0.1933,
    0.19340000000000002, 0.1935, 0.19360000000000002, 0.1937, 0.1938,
    0.19390000000000002, 0.194, 0.19410000000000002, 0.1942, 0.1943,
    0.19440000000000002, 0.1945, 0.19460000000000002, 0.1947, 0.1948,
    0.19490000000000002, 0.195, 0.19510000000000002, 0.1952, 0.1953,
    0.19540000000000002, 0.1955, 0.19560000000000002, 0.1957, 0.1958,
    0.19590000000000002, 0.196, 0.19610000000000002, 0.1962, 0.1963,
    0.19640000000000002, 0.1965, 0.1966, 0.1967, 0.1968, 0.19690000000000002,
    0.197, 0.1971, 0.19720000000000001, 0.1973, 0.19740000000000002, 0.1975,
    0.1976, 0.19770000000000001, 0.1978, 0.19790000000000002, 0.198, 0.1981,
    0.19820000000000002, 0.1983, 0.19840000000000002, 0.1985, 0.1986,
    0.19870000000000002, 0.1988, 0.19890000000000002, 0.199, 0.1991,
    0.19920000000000002, 0.1993, 0.19940000000000002, 0.1995, 0.1996,
    0.19970000000000002, 0.1998, 0.19990000000000002, 0.2 };

  int b_ndbl;
  double anew;
  double apnd;
  double cdiff;
  int nm1d2;
  int k;
  double y;
  int b_apnd;
  int absb;
  emxArray_real_T *b_y;
  emxArray_real_T *c_y;
  emxArray_real_T *d_y;
  unsigned int outsize[2];
  theta = b * 3.1415926535897931 / 180.0;
  dn = 1.0 / fs;

  /* fn=f/fs; */
  ndbl = 6.2831853071795862 * f;
  for (mid_i = 0; mid_i < 2001; mid_i++) {
    xa[mid_i] = ndbl * b_b[mid_i] + theta;
  }

  b_sin(xa);
  for (mid_i = 0; mid_i < 2001; mid_i++) {
    xa[mid_i] *= A;
  }

  if (rtIsNaN(dn)) {
    b_ndbl = 0;
    anew = rtNaN;
    apnd = 0.2;
  } else if ((dn == 0.0) || (dn < 0.0)) {
    b_ndbl = -1;
    anew = 0.0;
    apnd = 0.2;
  } else if (rtIsInf(dn)) {
    b_ndbl = 0;
    anew = 0.0;
    apnd = 0.2;
  } else {
    anew = 0.0;
    ndbl = floor(0.2 / dn + 0.5);
    apnd = ndbl * dn;
    if (dn > 0.0) {
      cdiff = apnd - 0.2;
    } else {
      cdiff = 0.2 - apnd;
    }

    if (fabs(cdiff) < 8.8817841970012528E-17) {
      ndbl++;
      apnd = 0.2;
    } else if (cdiff > 0.0) {
      apnd = (ndbl - 1.0) * dn;
    } else {
      ndbl++;
    }

    if (ndbl >= 0.0) {
      b_ndbl = (int)ndbl - 1;
    } else {
      b_ndbl = -1;
    }
  }

  mid_i = xd1->size[0] * xd1->size[1];
  xd1->size[0] = 1;
  xd1->size[1] = b_ndbl + 1;
  emxEnsureCapacity((emxArray__common *)xd1, mid_i, (int)sizeof(double));
  if (b_ndbl + 1 > 0) {
    xd1->data[0] = anew;
    if (b_ndbl + 1 > 1) {
      xd1->data[b_ndbl] = apnd;
      nm1d2 = (b_ndbl + (b_ndbl < 0)) >> 1;
      for (k = 1; k < nm1d2; k++) {
        ndbl = (double)k * dn;
        xd1->data[k] = anew + ndbl;
        xd1->data[b_ndbl - k] = apnd - ndbl;
      }

      if (nm1d2 << 1 == b_ndbl) {
        xd1->data[nm1d2] = (anew + apnd) / 2.0;
      } else {
        ndbl = (double)nm1d2 * dn;
        xd1->data[nm1d2] = anew + ndbl;
        xd1->data[nm1d2 + 1] = apnd - ndbl;
      }
    }
  }

  ndbl = 6.2831853071795862 * f;
  mid_i = xd1->size[0] * xd1->size[1];
  xd1->size[0] = 1;
  emxEnsureCapacity((emxArray__common *)xd1, mid_i, (int)sizeof(double));
  nm1d2 = xd1->size[0];
  b_ndbl = xd1->size[1];
  nm1d2 *= b_ndbl;
  for (mid_i = 0; mid_i < nm1d2; mid_i++) {
    xd1->data[mid_i] = ndbl * xd1->data[mid_i] + theta;
  }

  c_sin(xd1);

  /*  Quantization */
  y = 1.0 / q;
  mid_i = xd1->size[0] * xd1->size[1];
  xd1->size[0] = 1;
  emxEnsureCapacity((emxArray__common *)xd1, mid_i, (int)sizeof(double));
  nm1d2 = xd1->size[0];
  b_ndbl = xd1->size[1];
  nm1d2 *= b_ndbl;
  for (mid_i = 0; mid_i < nm1d2; mid_i++) {
    xd1->data[mid_i] = A * xd1->data[mid_i] * q;
  }

  b_round(xd1);
  mid_i = xd1->size[0] * xd1->size[1];
  xd1->size[0] = 1;
  emxEnsureCapacity((emxArray__common *)xd1, mid_i, (int)sizeof(double));
  nm1d2 = xd1->size[0];
  b_ndbl = xd1->size[1];
  nm1d2 *= b_ndbl;
  for (mid_i = 0; mid_i < nm1d2; mid_i++) {
    xd1->data[mid_i] *= y;
  }

  /*  Reconstruction */
  if (xd1->size[1] < 1) {
    b_ndbl = -1;
    b_apnd = 0;
  } else {
    b_ndbl = (int)floor(((double)xd1->size[1] - 1.0) + 0.5);
    b_apnd = b_ndbl + 1;
    nm1d2 = (b_ndbl - xd1->size[1]) + 1;
    absb = xd1->size[1];
    if (fabs(nm1d2) < 4.4408920985006262E-16 * (double)absb) {
      b_ndbl++;
      b_apnd = xd1->size[1];
    } else if (nm1d2 > 0) {
      b_apnd = b_ndbl;
    } else {
      b_ndbl++;
    }

    b_ndbl--;
  }

  emxInit_real_T(&b_y, 2);
  mid_i = b_y->size[0] * b_y->size[1];
  b_y->size[0] = 1;
  b_y->size[1] = b_ndbl + 1;
  emxEnsureCapacity((emxArray__common *)b_y, mid_i, (int)sizeof(double));
  if (b_ndbl + 1 > 0) {
    b_y->data[0] = 1.0;
    if (b_ndbl + 1 > 1) {
      b_y->data[b_ndbl] = b_apnd;
      nm1d2 = (b_ndbl + (b_ndbl < 0)) >> 1;
      for (k = 1; k < nm1d2; k++) {
        b_y->data[k] = 1.0 + (double)k;
        b_y->data[b_ndbl - k] = b_apnd - k;
      }

      if (nm1d2 << 1 == b_ndbl) {
        b_y->data[nm1d2] = (1.0 + (double)b_apnd) / 2.0;
      } else {
        b_y->data[nm1d2] = 1.0 + (double)nm1d2;
        b_y->data[nm1d2 + 1] = b_apnd - nm1d2;
      }
    }
  }

  y = 1.0 / (dn / 0.0001);
  if (rtIsNaN(y)) {
    b_ndbl = 0;
    anew = rtNaN;
    apnd = xd1->size[1];
  } else if ((y == 0.0) || ((1 < xd1->size[1]) && (y < 0.0)) || ((xd1->size[1] <
    1) && (y > 0.0))) {
    b_ndbl = -1;
    anew = 1.0;
    apnd = xd1->size[1];
  } else if (rtIsInf(y)) {
    b_ndbl = 0;
    anew = 1.0;
    apnd = xd1->size[1];
  } else {
    anew = 1.0;
    ndbl = floor(((double)xd1->size[1] - 1.0) / y + 0.5);
    apnd = 1.0 + ndbl * y;
    if (y > 0.0) {
      cdiff = apnd - (double)xd1->size[1];
    } else {
      cdiff = (double)xd1->size[1] - apnd;
    }

    absb = xd1->size[1];
    if (1 >= absb) {
      absb = 1;
    }

    if (fabs(cdiff) < 4.4408920985006262E-16 * (double)absb) {
      ndbl++;
      apnd = xd1->size[1];
    } else if (cdiff > 0.0) {
      apnd = 1.0 + (ndbl - 1.0) * y;
    } else {
      ndbl++;
    }

    if (ndbl >= 0.0) {
      b_ndbl = (int)ndbl - 1;
    } else {
      b_ndbl = -1;
    }
  }

  emxInit_real_T(&c_y, 2);
  mid_i = c_y->size[0] * c_y->size[1];
  c_y->size[0] = 1;
  c_y->size[1] = b_ndbl + 1;
  emxEnsureCapacity((emxArray__common *)c_y, mid_i, (int)sizeof(double));
  if (b_ndbl + 1 > 0) {
    c_y->data[0] = anew;
    if (b_ndbl + 1 > 1) {
      c_y->data[b_ndbl] = apnd;
      nm1d2 = (b_ndbl + (b_ndbl < 0)) >> 1;
      for (k = 1; k < nm1d2; k++) {
        ndbl = (double)k * y;
        c_y->data[k] = anew + ndbl;
        c_y->data[b_ndbl - k] = apnd - ndbl;
      }

      if (nm1d2 << 1 == b_ndbl) {
        c_y->data[nm1d2] = (anew + apnd) / 2.0;
      } else {
        ndbl = (double)nm1d2 * y;
        c_y->data[nm1d2] = anew + ndbl;
        c_y->data[nm1d2 + 1] = apnd - ndbl;
      }
    }
  }

  emxInit_real_T(&d_y, 2);
  mid_i = d_y->size[0] * d_y->size[1];
  d_y->size[0] = 1;
  d_y->size[1] = xd1->size[1];
  emxEnsureCapacity((emxArray__common *)d_y, mid_i, (int)sizeof(double));
  nm1d2 = xd1->size[0] * xd1->size[1];
  for (mid_i = 0; mid_i < nm1d2; mid_i++) {
    d_y->data[mid_i] = xd1->data[mid_i];
  }

  b_ndbl = b_y->size[1];
  for (mid_i = 0; mid_i < 2; mid_i++) {
    outsize[mid_i] = (unsigned int)c_y->size[mid_i];
  }

  mid_i = x_recon->size[0] * x_recon->size[1];
  x_recon->size[0] = 1;
  emxEnsureCapacity((emxArray__common *)x_recon, mid_i, (int)sizeof(double));
  mid_i = x_recon->size[0] * x_recon->size[1];
  x_recon->size[1] = (int)outsize[1];
  emxEnsureCapacity((emxArray__common *)x_recon, mid_i, (int)sizeof(double));
  nm1d2 = (int)outsize[1];
  for (mid_i = 0; mid_i < nm1d2; mid_i++) {
    x_recon->data[mid_i] = rtNaN;
  }

  if (c_y->size[1] == 0) {
  } else {
    if (b_y->data[1] < b_y->data[0]) {
      mid_i = b_ndbl >> 1;
      for (absb = 1; absb <= mid_i; absb++) {
        ndbl = b_y->data[absb - 1];
        b_y->data[absb - 1] = b_y->data[b_ndbl - absb];
        b_y->data[b_ndbl - absb] = ndbl;
      }

      nm1d2 = xd1->size[1] >> 1;
      for (absb = 1; absb <= nm1d2; absb++) {
        b_ndbl = xd1->size[1] - absb;
        ndbl = d_y->data[absb - 1];
        d_y->data[absb - 1] = d_y->data[b_ndbl];
        d_y->data[b_ndbl] = ndbl;
      }
    }

    for (k = 0; k + 1 <= c_y->size[1]; k++) {
      if (rtIsNaN(c_y->data[k])) {
        x_recon->data[k] = rtNaN;
      } else if ((c_y->data[k] > b_y->data[b_y->size[1] - 1]) || (c_y->data[k] <
                  b_y->data[0])) {
      } else {
        nm1d2 = 1;
        b_ndbl = 2;
        absb = b_y->size[1];
        while (absb > b_ndbl) {
          mid_i = (nm1d2 >> 1) + (absb >> 1);
          if (((nm1d2 & 1) == 1) && ((absb & 1) == 1)) {
            mid_i++;
          }

          if (c_y->data[k] >= b_y->data[mid_i - 1]) {
            nm1d2 = mid_i;
            b_ndbl = mid_i + 1;
          } else {
            absb = mid_i;
          }
        }

        ndbl = (c_y->data[k] - b_y->data[nm1d2 - 1]) / (b_y->data[nm1d2] -
          b_y->data[nm1d2 - 1]);
        if (ndbl == 0.0) {
          x_recon->data[k] = d_y->data[nm1d2 - 1];
        } else if (ndbl == 1.0) {
          x_recon->data[k] = d_y->data[nm1d2];
        } else if (d_y->data[nm1d2 - 1] == d_y->data[nm1d2]) {
          x_recon->data[k] = d_y->data[nm1d2 - 1];
        } else {
          x_recon->data[k] = (1.0 - ndbl) * d_y->data[nm1d2 - 1] + ndbl *
            d_y->data[nm1d2];
        }
      }
    }
  }

  emxFree_real_T(&d_y);
  emxFree_real_T(&c_y);
  emxFree_real_T(&b_y);

  /*  plot(xa); */
  /*  hold on; */
  /*  plot(x_recon, 'r'); */
}

/*
 * File trailer for L6_1.c
 *
 * [EOF]
 */
